# Excel/CSV Import Guide for Stock Items

## Overview
This guide explains how to import stock items using Excel or CSV files that match the C# `Stockitem` model structure.

## C# Model Structure
```csharp
public class Stockitem
{
    public int Id { get; set; }                // Auto-generated
    public DateTime Date { get; set; }         // Required
    public string ItemCode { get; set; }       // Required
    public string ItemName { get; set; }       // Required
    public string Description { get; set; }    // Optional
    public int GSM { get; set; }              // Optional (default: 0)
    public string Size { get; set; }          // Optional
    public string Brand { get; set; }         // Optional
    public string Color { get; set; }         // Optional
    public string Unit { get; set; }          // Required (ream/sheet/kg)
    public int OpeningStock { get; set; }     // Optional (default: 0)
    public int StockIn { get; set; }          // Optional (default: 0)
    public int StockOut { get; set; }         // Optional (default: 0)
    public int ClosingStock { get; set; }     // Auto-calculated
    public string Remark { get; set; }        // Optional
}
```

## Excel Template Structure

### Required Columns
| Column Name | Data Type | Required | Validation | Example |
|-------------|-----------|----------|------------|---------|
| Date | DateTime | ✓ | Valid date format | 2024-01-15 |
| ItemCode | String | ✓ | Non-empty text | PAPER001 |
| ItemName | String | ✓ | Non-empty text | A4 Copy Paper |
| Unit | String | ✓ | ream/sheet/kg only | ream |

### Optional Columns
| Column Name | Data Type | Required | Default | Example |
|-------------|-----------|----------|---------|---------|
| Description | String | ✗ | Empty | High quality paper |
| GSM | Integer | ✗ | 0 | 80 |
| Size | String | ✗ | Empty | A4 |
| Brand | String | ✗ | Empty | JK Paper |
| Color | String | ✗ | Empty | White |
| OpeningStock | Integer | ✗ | 0 | 100 |
| StockIn | Integer | ✗ | 0 | 50 |
| StockOut | Integer | ✗ | 0 | 20 |
| Remark | String | ✗ | Empty | Initial stock |

### Auto-Calculated Fields
- **Id**: Auto-generated by database
- **ClosingStock**: Calculated as `OpeningStock + StockIn - StockOut`

## Import Process

### Step 1: Download Template
1. Click "Import Excel/CSV" button
2. Click "Download Template" to get the Excel file
3. The template includes:
   - Sample data with correct format
   - Instructions sheet with field specifications
   - Proper column headers

### Step 2: Prepare Your Data
1. Open the downloaded template
2. Replace sample data with your actual data
3. Ensure all required fields are filled
4. Follow the data format requirements:
   - **Date**: Use YYYY-MM-DD or MM/DD/YYYY format
   - **Numbers**: Use integers only (no decimals)
   - **Unit**: Must be exactly "ream", "sheet", or "kg"
   - **Text**: Keep within reasonable lengths

### Step 3: Upload and Validate
1. Save your Excel file or export as CSV
2. Click "Choose File" and select your file
3. The system will:
   - Parse the file
   - Validate each row
   - Show validation results
   - Display preview of first 5 rows

### Step 4: Review and Import
1. Check validation summary:
   - **Valid Records**: Number of rows that passed validation
   - **Errors**: Number of validation errors found
   - **Total Rows**: Total rows processed
2. Review error messages if any
3. Click "Import X Items" to proceed
4. Wait for import completion

## Validation Rules

### Date Validation
- Must be a valid date
- Accepts multiple formats (YYYY-MM-DD, MM/DD/YYYY, etc.)
- Converted to ISO format for C# DateTime

### String Validation
- Required strings cannot be empty
- Optional strings default to empty if not provided
- Trimmed of leading/trailing spaces

### Integer Validation
- Must be valid positive integers
- No decimal values allowed
- Negative values not permitted for stock quantities
- Default to 0 if not provided

### Unit Validation
- Must be exactly one of: "ream", "sheet", "kg"
- Case-insensitive matching
- Converted to lowercase for consistency

## Error Handling

### Common Errors
1. **Missing Required Fields**: Date, ItemCode, ItemName, Unit must be provided
2. **Invalid Date Format**: Use standard date formats
3. **Invalid Numbers**: Stock quantities must be positive integers
4. **Invalid Unit**: Must be ream, sheet, or kg
5. **Empty Required Fields**: Required fields cannot be blank

### Error Messages
- Each error includes row number for easy identification
- Specific field name and validation rule that failed
- Example: "Row 5: GSM must be a positive integer"

## Best Practices

### Data Preparation
1. **Use the Template**: Always start with the downloaded template
2. **Check Data Types**: Ensure numbers are formatted as numbers, not text
3. **Validate Dates**: Use consistent date format throughout
4. **Clean Data**: Remove extra spaces and special characters
5. **Test Small Batches**: Import a few rows first to test

### File Management
1. **Save Backup**: Keep original data file as backup
2. **Use Descriptive Names**: Name files with date/version
3. **Check File Size**: Large files may take longer to process
4. **Format Consistency**: Stick to Excel or CSV format

### Import Strategy
1. **Start Small**: Test with 5-10 rows first
2. **Batch Import**: For large datasets, consider multiple smaller imports
3. **Verify Results**: Check imported data in the table
4. **Monitor Errors**: Address validation errors before retrying

## Troubleshooting

### File Upload Issues
- **File Not Recognized**: Ensure file extension is .xlsx, .xls, or .csv
- **File Too Large**: Break large files into smaller batches
- **Corrupted File**: Re-save the file and try again

### Validation Failures
- **Check Required Fields**: Ensure Date, ItemCode, ItemName, Unit are filled
- **Number Format**: Make sure numeric fields contain only numbers
- **Date Format**: Use standard date formats (YYYY-MM-DD recommended)
- **Unit Values**: Use only "ream", "sheet", or "kg"

### Import Failures
- **Network Issues**: Check internet connection and retry
- **Server Errors**: Contact system administrator
- **Duplicate Data**: Check for duplicate ItemCodes
- **Permission Issues**: Ensure you have import permissions

## Sample Data

### Excel Template Sample
```
Date        | ItemCode | ItemName      | Description           | GSM | Size | Brand     | Color | Unit  | OpeningStock | StockIn | StockOut | Remark
2024-01-15  | PAPER001 | A4 Copy Paper | High quality paper    | 80  | A4   | JK Paper  | White | ream  | 100          | 50      | 20       | Initial stock
2024-01-16  | PAPER002 | A3 Art Paper  | Premium art paper     | 120 | A3   | Century   | Cream | sheet | 200          | 100     | 30       | Art department
2024-01-17  | CARD001  | Business Card | Heavy cardstock       | 300 | 3.5x2| Premium   | White | kg    | 50           | 25      | 10       | Marketing
```

### CSV Format Sample
```csv
Date,ItemCode,ItemName,Description,GSM,Size,Brand,Color,Unit,OpeningStock,StockIn,StockOut,Remark
2024-01-15,PAPER001,A4 Copy Paper,High quality paper,80,A4,JK Paper,White,ream,100,50,20,Initial stock
2024-01-16,PAPER002,A3 Art Paper,Premium art paper,120,A3,Century,Cream,sheet,200,100,30,Art department
```

## Support

For technical support or questions about the import process:
1. Check this documentation first
2. Verify your data matches the C# model structure
3. Test with the provided template
4. Contact system administrator if issues persist

---

**Note**: This import feature is designed to work specifically with the C# `Stockitem` model. Ensure your data structure matches exactly for successful imports.